{
  "enabled": true,
  "name": "LLM Service Validator",
  "description": "Validates LLM service files for interface compliance, security, and functionality when changes are made to server/services/llm/ directory",
  "version": "1",
  "when": {
    "type": "userTriggered",
    "patterns": [
      "server/services/llm/**/*"
    ]
  },
  "then": {
    "type": "askAgent",
    "prompt": "A file in server/services/llm/ has been modified. Please perform the following validation:\n\n1) If it's a Provider or LLMServiceFactory/config file:\n   - Validate interface parity vs BaseLLMProvider.js (required methods, streaming, retries, timeouts)\n   - Verify token-limit logic is enforced (truncate/segment), no unbounded concatenation\n   - Flag any logging of full prompts or full model outputs; suggest secure redaction\n\n2) If it's PromptBuilder or ResponseParser:\n   - Show a before/after diff of any prompt template changes (system/user/metadata)\n   - Run only unit tests for PromptBuilder/ResponseParser and providers that depend on them\n   - Check JSON schema parsing and error handling for malformed responses\n\n3) Output a PASS/WARN/FAIL report with specific file/line links and minimal suggested edits\n\n4) Do not auto-edit other files; propose changes inline\n\nFocus on the modified files and provide actionable feedback for maintaining code quality and security."
  }
}